<!DOCTYPE html> 
<html>
    <head>
        <title>Sign Up Form</title>
        <link rel="stylesheet" href="styles_todo.css"> 
    </head>
    <body>
        <button class="darkmodebtn" onclick="myMove()">üåô</button>
        <form>            
            <h1>Sign Up</h1>
            <p>Please fill in this form to create an account.</p>
            <hr>

            <label for="email"><b>Email</b></label>
            <input type="email" placeholder="Enter Email" name="email" required>

            <label for="password"><b>Password</b></label>
            <div class="password-container">
                <input type="password" id="password" placeholder="Enter Password" name="password" required>
                <span class="toggle-password" data-target="password">üëÄ</span>
            </div>
            <span id="password-strength" style="font-size: 14px; display: none;"></span>

            <label for="password-repeat"><b>Repeat Password</b></label>
            <div class="password-container">
                <input type="password" id="password-repeat" placeholder="Repeat Password" name="password-repeat" required>
                <span class="toggle-password" data-target="password-repeat">üëÄ</span>
            </div>
            <span id="pwd-alert" style="color: red; font-size: 14px; display: none;">Passwords do not match!</span>

            <label for="birthdate"><b>Date of Birth</b></label>
            <input type="date" id="birthdate" name="birthdate" required>
            <button type="button" onclick="calculateAge()" style="background-color: #5f9ea0; width: auto; padding: 8px 16px; margin-top: 4px;">Kolik je mi dn√≠?</button>
            <div id="age-result" style="margin-top: 8px; font-size: 14px; display: none;"></div>

            <label for="profile-picture"><b>Profile Picture</b></label>
            <input type="file" name="profile-picture" accept="image/*">

            <label><b>Choose Your Plan</b></label>
            <div class="plan-options">
                <label class="plan-option">
                    <input type="radio" name="plan" value="free" required>
                    <span>Free Plan</span>
                </label>
                <label class="plan-option">
                    <input type="radio" name="plan" value="premium">
                    <span>Premium</span>
                </label>
                <label class="plan-option">
                    <input type="radio" name="plan" value="super-premium">
                    <span>Super Premium MAX Infinity</span>
                </label>
            </div>

            <label>
                <input type="checkbox" name="newsletter" checked> I want to receive newsletter
            </label>

            <p>By creating an account you agree to our <a href="https://www.gchd.cz/dokumenty/" style="color:dodgerblue">Terms & Privacy</a>.</p>

            <div class="button-container">
                <button type="button" class="cancelbtn">Cancel</button>
                <button type="submit" class="signupbtn">Sign Up</button>
            </div>
        </form>

        <div id="todo-container">
            <h2>√ökoly</h2>
            <div id="active-tasks"></div>
            <div class="add-task-container">
                <input type="text" id="new-task-input" placeholder="+ Polo≈æka na seznamu">
                <button onclick="addTask()">P≈ôidat</button>
            </div>
            <div id="completed-separator" style="display: none;">
                <hr>
                <p id="completed-count">0 dokonƒçen√Ωch polo≈æek</p>
            </div>
            <div id="completed-tasks"></div>
        </div>

        <script>
            const password = document.getElementById('password');
            const passwordRepeat = document.getElementById('password-repeat');
            const passwordError = document.getElementById('pwd-alert');
            const passwordStrength = document.getElementById('password-strength');
            const form = document.querySelector('form');

            function checkPasswordStrength() {
                const pwd = password.value;

                if (pwd === '') {
                    passwordStrength.style.display = 'none';
                    return true;
                }

                const hasLower = /[a-z]/.test(pwd);
                const hasUpper = /[A-Z]/.test(pwd);
                const hasDigit = /[0-9]/.test(pwd);
                const hasSpecial = /[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(pwd);

                if (hasLower && hasUpper && hasDigit && hasSpecial) {
                    passwordStrength.textContent = '‚úì Password is strong';
                    passwordStrength.style.color = 'green';
                    passwordStrength.style.display = 'block';
                    return true;
                } else {
                    let missing = [];
                    if (!hasLower) missing.push('lowercase');
                    if (!hasUpper) missing.push('uppercase');
                    if (!hasDigit) missing.push('numbers');
                    if (!hasSpecial) missing.push('special characters');

                    passwordStrength.textContent = '‚úó Password must contain: ' + missing.join(', ');
                    passwordStrength.style.color = 'red';
                    passwordStrength.style.display = 'block';
                    return false;
                }
            }

            function checkPasswordMatch() {
                if (passwordRepeat.value === '') {
                    passwordError.style.display = 'none';
                    return true;
                }

                if (password.value !== passwordRepeat.value) {
                    passwordError.style.display = 'block';
                    return false;
                } else {
                    passwordError.style.display = 'none';
                    return true;
                }
            }

            password.addEventListener('input', function() {
                checkPasswordStrength();
                checkPasswordMatch();
            });
            passwordRepeat.addEventListener('input', checkPasswordMatch);

            // Validate on form submission
            form.addEventListener('submit', function(e) {
                const isPasswordStrong = checkPasswordStrength();
                const doPasswordsMatch = checkPasswordMatch();

                if (!isPasswordStrong) {
                    e.preventDefault();
                    alert('Password must contain lowercase, uppercase, numbers, and special characters!');
                    return;
                }

                if (!doPasswordsMatch) {
                    e.preventDefault();
                    alert('Passwords do not match! Please make sure both passwords are identical.');
                }
            });

            document.querySelectorAll('.toggle-password').forEach(function(eyeIcon) {
                eyeIcon.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const passwordInput = document.getElementById(targetId);

                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        this.textContent = 'üôà';
                    } else {
                        passwordInput.type = 'password';
                        this.textContent = 'üëÄ';
                    }
                });
            });

            function calculateAge() {
                const birthdateInput = document.getElementById('birthdate');
                const resultDiv = document.getElementById('age-result');

                if (!birthdateInput.value) {
                    alert('Pros√≠m zadej sv√© datum narozen√≠!');
                    return;
                }

                const birthDate = new Date(birthdateInput.value);
                const today = new Date();

                const diffTime = today - birthDate;
                const daysLived = Math.floor(diffTime / (1000 * 60 * 60 * 24));

                const nextBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                if (nextBirthday < today) {
                    nextBirthday.setFullYear(today.getFullYear() + 1);
                }

                const daysUntilBirthday = Math.ceil((nextBirthday - today) / (1000 * 60 * 60 * 24));

                resultDiv.innerHTML = `<b>≈Ωije≈° u≈æ ${daysLived} dn√≠!</b><br>Za ${daysUntilBirthday} dn√≠ bude≈° m√≠t narozeniny! üéÇ`;
                resultDiv.style.display = 'block';
                resultDiv.style.color = '#04AA6D';
            }

            let taskId = 0;

            function addTask() {
                const input = document.getElementById('new-task-input');
                const taskText = input.value.trim();

                if (taskText === '') {
                    return;
                }

                const activeTasksDiv = document.getElementById('active-tasks');
                const taskDiv = document.createElement('div');
                taskDiv.className = 'task-item';
                taskDiv.id = 'task-' + taskId;

                taskDiv.innerHTML = `
                    <input type="checkbox" onchange="toggleTask(${taskId})">
                    <span>${taskText}</span>
                `;

                activeTasksDiv.appendChild(taskDiv);
                input.value = '';
                taskId++;
            }

            function toggleTask(id) {
                const taskDiv = document.getElementById('task-' + id);
                const checkbox = taskDiv.querySelector('input[type="checkbox"]');
                const activeTasksDiv = document.getElementById('active-tasks');
                const completedTasksDiv = document.getElementById('completed-tasks');
                const separator = document.getElementById('completed-separator');

                if (checkbox.checked) {
                    taskDiv.classList.add('completed');
                    completedTasksDiv.appendChild(taskDiv);
                } else {
                    taskDiv.classList.remove('completed');
                    activeTasksDiv.appendChild(taskDiv);
                }

                const completedCount = completedTasksDiv.children.length;
                const countText = document.getElementById('completed-count');

                if (completedCount > 0) {
                    separator.style.display = 'block';
                    countText.textContent = completedCount + (completedCount === 1 ? ' dokonƒçen√° polo≈æka' : ' dokonƒçen√© polo≈æky');
                } else {
                    separator.style.display = 'none';
                }
            }

            document.getElementById('new-task-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addTask();
                }
            });

            // Dark mode toggle s animac√≠ - obj√≠≈ædƒõn√≠ cel√©ho ƒçtverce
            let cornerPosition = 0; // 0: vpravo naho≈ôe, 1: vlevo naho≈ôe, 2: vlevo dole, 3: vpravo dole

            function myMove() {
                const elem = document.querySelector('.darkmodebtn');
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                const buttonWidth = elem.offsetWidth;
                const buttonHeight = elem.offsetHeight;
                const margin = 8;

                // P≈ôepni dark mode
                document.body.classList.toggle('dark-mode');

                // Definuj pozice roh≈Ø: [horizontal, vertical]
                const corners = [
                    { h: screenWidth - buttonWidth - margin, v: margin },        // vpravo naho≈ôe
                    { h: margin, v: margin },                                     // vlevo naho≈ôe
                    { h: margin, v: screenHeight - buttonHeight - margin },       // vlevo dole
                    { h: screenWidth - buttonWidth - margin, v: screenHeight - buttonHeight - margin } // vpravo dole
                ];

                const currentCorner = corners[cornerPosition];
                const nextPosition = (cornerPosition + 1) % 4;
                const targetCorner = corners[nextPosition];

                // Animace
                let currentH = currentCorner.h;
                let currentV = currentCorner.v;
                const targetH = targetCorner.h;
                const targetV = targetCorner.v;

                let id = setInterval(function() {
                    let reachedH = false;
                    let reachedV = false;

                    // Horizont√°ln√≠ pohyb
                    if (Math.abs(currentH - targetH) < 5) {
                        currentH = targetH;
                        reachedH = true;
                    } else {
                        currentH += currentH < targetH ? 5 : -5;
                    }

                    // Vertik√°ln√≠ pohyb
                    if (Math.abs(currentV - targetV) < 5) {
                        currentV = targetV;
                        reachedV = true;
                    } else {
                        currentV += currentV < targetV ? 5 : -5;
                    }

                    elem.style.left = currentH + 'px';
                    elem.style.top = currentV + 'px';
                    elem.style.right = 'auto';
                    elem.style.bottom = 'auto';

                    if (reachedH && reachedV) {
                        clearInterval(id);
                        cornerPosition = nextPosition;
                    }
                }, 5);
            }
        </script>
    </body>
</html>